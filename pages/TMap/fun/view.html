<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>地图视图 | TMap-OL-Doc</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/tmap-ol-doc/img/logo.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/tmap-ol-doc/assets/css/0.styles.067b666c.css" as="style"><link rel="preload" href="/tmap-ol-doc/assets/js/app.9340124c.js" as="script"><link rel="preload" href="/tmap-ol-doc/assets/js/2.e44ad201.js" as="script"><link rel="preload" href="/tmap-ol-doc/assets/js/52.d54d0ee0.js" as="script"><link rel="prefetch" href="/tmap-ol-doc/assets/js/10.4ac103c5.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/11.38f8f5cc.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/12.dd3edee4.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/13.384d9df2.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/14.43c3abe2.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/15.637aa66e.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/16.2deaaec8.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/17.16c0fa05.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/18.16c1ea9d.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/19.4634a2f9.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/20.9c84fccc.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/21.a88c6bd4.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/22.722b8b53.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/23.38a7c543.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/24.6588a75b.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/25.3d0e1a00.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/26.fa2080c4.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/27.7ea2beb1.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/28.823f2305.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/29.fd7002ce.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/3.18b6b865.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/30.92b1e290.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/31.27434288.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/32.978f13cc.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/33.82ef90e5.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/34.cbbb686c.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/35.1b806614.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/36.c836c359.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/37.5c3e3c9f.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/38.adb52c69.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/39.46cbe929.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/4.ee8b6a20.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/40.0184d80c.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/41.b6a445da.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/42.006dcd91.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/43.ccd14454.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/44.9af99c84.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/45.7beb68d7.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/46.25ed8e4d.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/47.e1fe9df7.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/48.3ec88b93.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/49.83fad0e6.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/5.2e78bccb.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/50.1c326822.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/51.4fbf4a32.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/53.b1c4bcd2.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/54.eea6e6e6.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/6.bacd6f42.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/7.59a949d7.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/8.0b3163c3.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/9.a786f87a.js">
    <link rel="stylesheet" href="/tmap-ol-doc/assets/css/0.styles.067b666c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/tmap-ol-doc/" class="home-link router-link-active"><img src="/tmap-ol-doc/img/logo.png" alt="TMap-OL-Doc" class="logo"> <span class="site-name can-hide">TMap-OL-Doc</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/tmap-ol-doc/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/tmap-ol-doc/pages/TMap/" class="nav-link router-link-active">
  TMap开发文档
</a></div><div class="nav-item"><a href="/tmap-ol-doc/pages/OL/" class="nav-link">
  OL简明教程
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/tmap-ol-doc/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/tmap-ol-doc/pages/TMap/" class="nav-link router-link-active">
  TMap开发文档
</a></div><div class="nav-item"><a href="/tmap-ol-doc/pages/OL/" class="nav-link">
  OL简明教程
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/tmap-ol-doc/pages/TMap/" aria-current="page" class="sidebar-link">简介</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>开始</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tmap-ol-doc/pages/TMap/start/use.html" class="sidebar-link">使用</a></li><li><a href="/tmap-ol-doc/pages/TMap/start/start.html" class="sidebar-link">开始创建第一个地图</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>功能及示例</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tmap-ol-doc/pages/TMap/fun/init.html" class="sidebar-link">地图初始化</a></li><li><a href="/tmap-ol-doc/pages/TMap/fun/view.html" aria-current="page" class="active sidebar-link">地图视图</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/view.html#改变地图视图" class="sidebar-link">改变地图视图</a></li><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/view.html#动画改变视图" class="sidebar-link">动画改变视图</a></li><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/view.html#缩放按钮功能" class="sidebar-link">缩放按钮功能</a></li><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/view.html#获取地图当前视口边界坐标" class="sidebar-link">获取地图当前视口边界坐标</a></li><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/view.html#地图自适应缩放" class="sidebar-link">地图自适应缩放</a></li><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/view.html#获取一系列坐标的extent及经纬度最值" class="sidebar-link">获取一系列坐标的extent及经纬度最值</a></li><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/view.html#根据多个要素或几何图形缩放" class="sidebar-link">根据多个要素或几何图形缩放</a></li><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/view.html#距离计算" class="sidebar-link">距离计算</a></li><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/view.html#一系列点中心点获取" class="sidebar-link">一系列点中心点获取</a></li><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/view.html#获取每投影单位的米长" class="sidebar-link">获取每投影单位的米长</a></li><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/view.html#效果展示" class="sidebar-link">效果展示</a></li></ul></li><li><a href="/tmap-ol-doc/pages/TMap/fun/marker.html" class="sidebar-link">地图撒点</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tmap-ol-doc/pages/TMap/API/initMap.html" class="sidebar-link">initMap</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/resizeMap.html" class="sidebar-link">resizeMap</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/setMapContainer.html" class="sidebar-link">setMapContainer</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/setBaseMap.html" class="sidebar-link">setBaseMap</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getMapControls.html" class="sidebar-link">getMapControls</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/addMapControl.html" class="sidebar-link">addMapControl</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/removeMapControl.html" class="sidebar-link">removeMapControl</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getMapView.html" class="sidebar-link">getMapView</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/setMapView.html" class="sidebar-link">setMapView</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/animateMapView.html" class="sidebar-link">animateMapView</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/zoomIn.html" class="sidebar-link">zoomIn</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/zoomOut.html" class="sidebar-link">zoomOut</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getMapViewCoord.html" class="sidebar-link">getMapViewCoord</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/fitInView.html" class="sidebar-link">fitInView</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getCoordinatesExtent.html" class="sidebar-link">getCoordinatesExtent</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/fitInFeaturesOrGeometries.html" class="sidebar-link">fitInFeaturesOrGeometries</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getDistance.html" class="sidebar-link">getDistance</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getGeoCenterFromLngLats.html" class="sidebar-link">getGeoCenterFromLngLats</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getMetersPerUnit.html" class="sidebar-link">getMetersPerUnit</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/addIconMarkers.html" class="sidebar-link">addIconMarkers</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/removeLayer.html" class="sidebar-link">removeLayer</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getAllLayers.html" class="sidebar-link">getAllLayers</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/addOverLayMarkers.html" class="sidebar-link">addOverLayMarkers</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/removeOverlay.html" class="sidebar-link">removeOverlay</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getAllOverlays.html" class="sidebar-link">getAllOverlays</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/addVectorLayer.html" class="sidebar-link">addVectorLayer</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/addTextOnSource.html" class="sidebar-link">addTextOnSource</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/removeFeaturesOnSource.html" class="sidebar-link">removeFeaturesOnSource</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/removeFeaturesOnLayer.html" class="sidebar-link">removeFeaturesOnLayer</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getFeaturesFromLayer.html" class="sidebar-link">getFeaturesFromLayer</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getFeaturesFromSource.html" class="sidebar-link">getFeaturesFromSource</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="地图视图"><a href="#地图视图" class="header-anchor">#</a> 地图视图</h1> <h2 id="改变地图视图"><a href="#改变地图视图" class="header-anchor">#</a> 改变地图视图</h2> <p>上一章我们在初始化过程中给到了一些配置来设置地图初始视图,这个视图并非是不可改变的，如果了解了<a href="/tmap-ol-doc/pages/OL/base/View">View</a>这一部分就很好理解了，地图在初始化过程中实例化了一个<code>View</code>对象，我们可以通过<code>getMapView</code>获取这个对象打印一下来看看，通过这个对象我们可以拿到相应的配置项，当然如果你对<code>OL</code>熟悉的话，可以直接使用一些<code>OL</code>的对象方法来获取配置</p> <p>获取了之后呢，要想改变这个对象里的一些配置项又该怎么做呢，有<code>get</code>就有<code>set</code>，<code>setMapView</code>可以帮助你来改变这个对象的一些常用配置项</p> <p>我们通过代码例子一起来看看</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;当前视图对象：&quot;</span><span class="token punctuation">,</span> <span class="token function">getMapView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//改变中心点与缩放</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;setMapView&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setMapVIew</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">103.043</span><span class="token punctuation">,</span> <span class="token number">31.012312</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>点击<a href="/tmap-ol-doc/pages/TMap/fun/view.html#效果展示">效果展示</a>并点击改变视图查看地图效果</p> <p>打开控制台可查看当前地图<code>View</code>对象</p> <p>我们通过这个方法可以实现地图中心点的重新定位与缩放</p> <p>第一个参数为地图实例，这里我们已经这样用过很多次了，不用多说了吧</p> <p>第二个参数是一个对象形式，包含了<code>zoom</code>,<code>center</code>等</p> <div class="custom-block tip"><p class="custom-block-title">注：</p> <p>注意这里的<code>center</code>格式，坐标点用数组形式表示，这是<code>GIS</code>系统内对坐标的常用表述形式，<code>coord</code>形式坐标，一般单个坐标为<code>[lng,lat]</code>格式，多个坐标时再用一个数组把这个数组包起来，如<code>[[lng1,lat1],[lng2,lat1]]</code></p></div> <p>想了解更多用法，点击下方链接：</p> <p><a href="/tmap-ol-doc/pages/TMap/API/getMapView.html">API/getMapView</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/setMapView.html">API/setMapView</a></p> <h2 id="动画改变视图"><a href="#动画改变视图" class="header-anchor">#</a> 动画改变视图</h2> <p>刚才我们学会了如何改变视图，但是实际使用场景中，实现需要移动中心点并且缩放的功能一般不会使用上面的方法，而是需要实现一个带有动画效果的重新定位与缩放</p> <p>为什么需要动画？</p> <p>因为地图瓦片的请求与加载需要时间，视图改变会触发瓦片的请求与渲染，如果没有动画，而直接调用<code>setMapView</code>,瞬间的视图变化会导致瓦片请求跟不上视图的更新，会影响用户的视觉体验，但是，我们通过给视图改变一个过渡时间，尽可能的让过渡时间与加载时间匹配，才能有一个良好的视觉效果</p> <p>试试用<code>animateMapView</code>实现动画移动效果吧</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;animateMapView&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">animateMapView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
        <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">103.043</span><span class="token punctuation">,</span> <span class="token number">31.012312</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">durationTime</span><span class="token operator">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>点击<a href="/tmap-ol-doc/pages/TMap/fun/view.html#效果展示">效果展示</a>并点击动画改变视图查看地图效果</p> <p>观察代码，对比<code>setMapView</code>的用法我们发现，除了第二个参数里多了个<code>durationTime</code>外几乎没有差别,而这个多的参数正是为我们动画的关键</p> <p>想了解更多用法，点击下方链接：</p> <p><a href="/tmap-ol-doc/pages/TMap/API/animateMapView.html">API/animateMapView</a></p> <h2 id="缩放按钮功能"><a href="#缩放按钮功能" class="header-anchor">#</a> 缩放按钮功能</h2> <p>我们在上一章学习控件的时候提到了一个<code>Zoom</code>控件，它的本质上是两个用于控制视图缩放的按钮,实际场景中这个功能确实十分常见且实用，但是我们一般不会使用控件去实现这个需求，因为实际需求中这两个按钮样式和位置不可能和控件完全相同，而覆盖样式相对来说比较麻烦，所以我们会选择自己实现按钮和相应的功能</p> <p>而功能<code>TMap</code>已经帮你实现了，你只需要在你自己的按钮点击事件中调用<code>zoomIn</code>,<code>zoomOut</code>即可,用法也十分简单，像下面这样就可以了</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token comment">// 放大</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;zoomIn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">zoomIn</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 缩小</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;zoomOut&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">zoomOut</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>点击<a href="/tmap-ol-doc/pages/TMap/fun/view.html#效果展示">效果展示</a>并点击<code>+</code>，<code>-</code>按钮查看地图效果</p> <p>这个<code>API</code>使用十分简单，只有一个地图实例作为参数，看地图效果可以看出这个缩放也是带动画的，没错，里面实际上是在执行<code>animateMapView</code>这个方法，每次<code>zoom</code>值<code>+1</code>或者<code>-1</code>，然后获取View对象的值，这里就不展开讲底层方法了，感兴趣可以去看看<a href="/tmap-ol-doc/tmap-ol-doc/pages/OL/TMapSourceCode/zoomIn.html">OL/FMap源码解析/zoomIn</a>源码解析</p> <p>关于这两个API更多请看下方链接：</p> <p><a href="/tmap-ol-doc/pages/TMap/API/zoomIn.html">API/zoomIn</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/zoomOut.html">API/zoomOut</a></p> <h2 id="获取地图当前视口边界坐标"><a href="#获取地图当前视口边界坐标" class="header-anchor">#</a> 获取地图当前视口边界坐标</h2> <p>有时候，我们需要通过当前窗口的经纬度范围来进行交互，我们需要拿到当前窗口的范围，试试<code>getMapViewCoord</code>吧</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;当前地图视口：&quot;</span><span class="token punctuation">,</span> <span class="token function">getMapViewCoord</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>不妨打开控制台看看</p> <p>你可以看到一个对象，里面包含了所有你可能用到的数据，包括<code>extent</code>以及外围<code>coord</code>格式范围等，现在你可以拿着这些数据完成你需要的操作了</p> <p>详情请点击下方链接：</p> <p><a href="/tmap-ol-doc/pages/TMap/API/getMapViewCoord.html">API/getMapViewCoord</a></p> <h2 id="地图自适应缩放"><a href="#地图自适应缩放" class="header-anchor">#</a> 地图自适应缩放</h2> <p>刚刚你可能注意到了，<code>getMapViewCoord</code>的返回值对象中有个<code>extent</code>，那这个<code>extent</code>到底是什么？</p> <p>其实<code>extent</code>是<code>ol</code>中一个十分重要的概念，它表明了一个地图上的矩形范围，不同于<code>coord</code>形式表示（<code>[[lng1,lat1],[lng2,lat1],[lng2,lat2][lng1,lat2]]</code>），<code>extent</code>是对这个数组扁平化去重，用一个一维数组表示了一个范围即<code>[lng1,lat2,lng2,lat1]</code></p> <p>它又有什么用呢？</p> <p>它表示了一个地图范围，它的作用自然是控制地图显示的范围了</p> <p>下面这个方法将带你们认识下<code>extent</code>的实际使用</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token keyword">const</span> <span class="token punctuation">{</span> extent <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getMapViewCoord</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//复原</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;reset&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">fitInView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> extent<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">padding</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>点击<a href="/tmap-ol-doc/pages/TMap/fun/view.html#效果展示">效果展示</a>随意拖动缩放地图后点击复原试试</p> <p>可以看到我们保存了地图初始状态的<code>extent</code>，点击按钮就会触发<code>fitInView</code>方法，适应大小回到初始状态</p> <p><code>padding</code>是带有默认值的，我们要是想回到原始位置，需要把<code>padding</code>设置为<code>0</code></p> <p>这是一个强大且常用的方法，一般用于保证多个点或者图形在视口上完全显示</p> <p>具体API请点击下方链接查看：</p> <p><a href="/tmap-ol-doc/pages/TMap/API/fitInView.html">API/fitInView</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/getMapViewCoord.html">API/getMapViewCoord</a></p> <h2 id="获取一系列坐标的extent及经纬度最值"><a href="#获取一系列坐标的extent及经纬度最值" class="header-anchor">#</a> 获取一系列坐标的extent及经纬度最值</h2> <p>上节我们提到了<code>fitInView</code>的使用场景，当有地图上有多个点的情况下，我们可能需要把点完全展示在视口内，我们就需要<code>fitInView</code>去实现，但是实现这个首先需要拿到点的<code>extent</code></p> <p><code>getCoordinatesExtent</code>也许可以帮到你</p> <p>先设置两个点打印下看看</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token keyword">const</span> points <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">103.02</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">31.11</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">103.54</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">31.01</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;点位extent:&quot;</span><span class="token punctuation">,</span> <span class="token function">getCoordinatesExtent</span><span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>打开控制台看看结果，里面包含了<code>extent</code>和<code>geom</code>以及经纬度的最值，<code>extent</code>可以用来控制显示</p> <p>为了方便查看，我下面调用了撒点和清除的<code>api</code>，可以暂时忽略，后面会仔细讲撒点的用法</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>   <span class="token comment">//撒点</span>
    <span class="token keyword">let</span> layer<span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;fitPoints&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      layer <span class="token operator">&amp;&amp;</span> <span class="token function">removeLayer</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> layer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      layer <span class="token operator">=</span> <span class="token function">addIconMarkers</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> points<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> coordsObj <span class="token operator">=</span> <span class="token function">getCoordinatesExtent</span><span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">fitInView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> coordsObj<span class="token punctuation">.</span>extent<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// fitInView(TMap, coordsObj.geom);</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>点击<a href="/tmap-ol-doc/pages/TMap/fun/view.html#效果展示">效果展示</a>点击撒点并适应显示按钮看看效果</p> <p>我们可以看到两个点刚好在视口范围内显示，因为有默认<code>padding</code>值的原因，点才没有贴着视口边界</p> <p>我们看到代码中注释掉的第8行，传进去了拿到的<code>geom</code>，实际这是允许的，<code>fitInView</code>方法支持传入<code>extent</code>或<code>geom</code>，二者效果无差别</p> <p>关于获取多个点位<code>extent</code>更多请点击下方链接：</p> <p><a href="/tmap-ol-doc/pages/TMap/API/getCoordinatesExtent.html">API/getCoordinatesExtent</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/fitInView.html">API/fitInView</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/addIconMarkers.html">API/addIconMarkers</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/removeLayer.html">API/removeLayer</a></p> <h2 id="根据多个要素或几何图形缩放"><a href="#根据多个要素或几何图形缩放" class="header-anchor">#</a> 根据多个要素或几何图形缩放</h2> <p>刚才我们已经学会了点的显示，但是实际使用场景中可不止是点一种，更多的是实现区域的完全展示，不一样的是，点我们需要获取一次<code>extent</code>再调用，而多个区域有一个自己的适应方法，不需要获得<code>extent</code>后再<code>fitInView</code>，直接一个<code>fitInFeaturesOrGeometries</code>可以搞定，试试吧</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token keyword">let</span> areaLayer<span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;fitGeos&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      areaLayer <span class="token operator">&amp;&amp;</span> <span class="token function">removeLayer</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> areaLayer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> drawSource<span class="token punctuation">,</span> drawLayer <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">addDrawLayer</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
      areaLayer <span class="token operator">=</span> drawLayer<span class="token punctuation">;</span>
      <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token constant">WKT</span><span class="token operator">:</span> <span class="token string">&quot;POLYGON((104.054595 30.544729,104.042064 30.514688,104.090301 30.489626,104.128066 30.533743,104.100257 30.543356,104.054595 30.544729))&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">radius</span><span class="token operator">:</span> <span class="token number">0.04223358312131609</span><span class="token punctuation">,</span>
          <span class="token constant">WKT</span><span class="token operator">:</span> <span class="token string">&quot;POINT(104.1061769104004 30.723644180297853)&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> feature <span class="token operator">=</span> <span class="token function">addWKTGeoOnSource</span><span class="token punctuation">(</span>drawSource<span class="token punctuation">,</span> item<span class="token punctuation">.</span><span class="token constant">WKT</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>radius<span class="token punctuation">)</span><span class="token punctuation">;</span>
        features<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">fitInFeaturesOrGeometries</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> features<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>点击<a href="/tmap-ol-doc/pages/TMap/fun/view.html#效果展示">效果展示</a>点击区域上图并适应显示按钮看看效果</p> <p>看了地图，是不是发现已经完美的将两个图形呈现在视口内</p> <p>再来看看代码，前面部分看不懂没关系，关于区域上图的部分我们后面自会讲到，在这里我们只需要清除，区域上图后我们会得到区域的<code>Feature</code>对象，把这些对象<code>push</code>到一个数组里然后作为<code>fitInFeaturesOrGeometries</code>的第二个参数就可以实现多个图形或者要素的适应显示了,这里传<code>Feature</code>对象数组和<code>Geometry</code>对象数组都可以实现这个效果，使用时可以灵活的选择合适的数据,但注意不要混用哦，一个数组中不可同时出现<code>Feature</code>和<code>Geometry</code></p> <p>多个图形时用这样使用，一个的话实现方法就有多种了</p> <p>如果你得到一个图形的<code>Feature</code>可以利用原型链上的<code>getGeometry()</code>方法得到的<code>Geometry</code>然后作为参数直接调用<code>fitInView</code>进行适应缩放</p> <p>当然也可以不用这么麻烦，<code>fitInFeaturesOrGeometries</code>接收数组参数，数组只存放一个
<code>Feature</code>或<code>Geometry</code>不就实现单个图形的适应显示了，具体的还是需要自己去尝试</p> <p>关于这个<code>API</code>更多请点击下方链接了解：</p> <p><a href="/tmap-ol-doc/pages/TMap/API/fitInFeaturesOrGeometries.html">API/fitInFeaturesOrGeometries</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/addDrawLayer.html">API/addDrawLayer</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/addWKTGeoOnSource.html">API/addWKTGeoOnSource</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/removeLayer.html">API/removeLayer</a></p> <h2 id="距离计算"><a href="#距离计算" class="header-anchor">#</a> 距离计算</h2> <p>有时候我们需要知道地图上两个点的距离，虽然网上关于计算两坐标点距离的方法很多，但是我们可以用FMap封装好的方法来进行距离计算</p> <p>试下getDistance的效果吧</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
      <span class="token string">&quot;两点距离为&quot;</span><span class="token punctuation">,</span>
      <span class="token function">getDistance</span><span class="token punctuation">(</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.06</span><span class="token punctuation">,</span>
          <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.67</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.063</span><span class="token punctuation">,</span>
          <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.672</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>打开控制台观察一下结果，可以看到我们已经得到了单位为<code>m</code>的两点间距</p> <p>用法十分简单，传入两个带有<code>lng</code>，<code>lat</code>的对象作为起始点，就可以得到他们的距离，</p> <p>关于这个方法更多请点击下方</p> <p><a href="/tmap-ol-doc/pages/TMap/API/getDistance.html">API/getDistance</a></p> <h2 id="一系列点中心点获取"><a href="#一系列点中心点获取" class="header-anchor">#</a> 一系列点中心点获取</h2> <p>当你得到一系列点，可能你并不需要恰好全部在视口内展示，你只是想固定一个的缩放值把它移到中间，移动我们前面已经讲过了，但是多个点的中心点我们该如何得知呢</p> <p><code>getGeoCenterFromLngLats</code>就可以解决这个问题</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
      <span class="token function">getGeoCenterFromLngLats</span><span class="token punctuation">(</span><span class="token string">&quot;坐标中心点为&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.054595</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.544729</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.042064</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.514688</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.090301</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.489626</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.100257</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.543356</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.054595</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.544729</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>打开控制台看看结果，我们得到了一个对象，包含了<code>coord</code>形式的<code>center</code>，中心点<code>lng</code>及<code>lat</code></p> <p>这个方法用法也很简单，更多要结合实际场景去使用</p> <p>了解更多点击下方链接：</p> <p><a href="/tmap-ol-doc/pages/TMap/API/getGeoCenterFromLngLats.html">API/getGeoCenterFromLngLats</a></p> <h2 id="获取每投影单位的米长"><a href="#获取每投影单位的米长" class="header-anchor">#</a> 获取每投影单位的米长</h2> <p>我们来看一下视图部分的最后一个<code>api</code>，可能视图相关方法不止这些,其他的我们会在后面部分结合具体需求讲到，言归正传，我们来说这个方法，这个方法可能并不常用，但是不能没有，在<code>gis</code>系统中，投影单位都不可能是<code>m</code>，但是实际需求中，我们都会用<code>m</code>做数据传递，那么我们就需要一个方法对投影单位和<code>m</code>进行转换</p> <p>getMetersPerUnit可以实现</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1投影单位的米长&quot;</span><span class="token punctuation">,</span> <span class="token function">getMetersPerUnit</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>打开控制台看看，你已经知道了当前地图1投影单位的米长</p> <p>那么只需要简单的乘除法就可以实现投影单位与米的转换了</p> <p>刚刚的<code>getDistance</code>甚至都可以通过两个投影坐标的数学运算搭配<code>getMetersPerUnit</code>得到两点的距离·米长，当然，我们开发过程中要讲求效率，当然怎么简单怎么来了</p> <p>了解更多点击下方链接：</p> <p><a href="/tmap-ol-doc/pages/TMap/API/getMetersPerUnit.html">API/getMetersPerUnit</a></p> <h2 id="效果展示"><a href="#效果展示" class="header-anchor">#</a> 效果展示</h2> <details class="custom-block details"><summary>点击查看完整实现代码</summary> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../css/ol.css<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../js/ol.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../js/mapConfig.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">body</span> <span class="token punctuation">{</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
      <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">#mapContainer1</span> <span class="token punctuation">{</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 100vw<span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>
      <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.buttons</span> <span class="token punctuation">{</span>
      <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
      <span class="token property">left</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
      <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
      <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span>-50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.buttons button</span> <span class="token punctuation">{</span>
      <span class="token property">background</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
      <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #666666<span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> #333333<span class="token punctuation">;</span>
      <span class="token property">border-radius</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>
      <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.view-btns</span> <span class="token punctuation">{</span>
      <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
      <span class="token property">right</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
      <span class="token property">bottom</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
      <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span>-50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.view-btns &gt; div</span> <span class="token punctuation">{</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
      <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
      <span class="token property">line-height</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>
      <span class="token property">margin</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
      <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #666666<span class="token punctuation">;</span>
      <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mapContainer1<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>buttons<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>setMapView<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>改变视图<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>animateMapView<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>动画移动视图<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>reset<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>复原<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fitPoints<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>撒点并适应显示<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>fitGeos<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>区域上图并适应显示<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>view-btns<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>zoomIn<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>+<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>zoomOut<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>-<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token comment">// #region init</span>
    <span class="token keyword">import</span> <span class="token punctuation">{</span>
      initMap<span class="token punctuation">,</span>
      getMapView<span class="token punctuation">,</span>
      setMapVIew<span class="token punctuation">,</span>
      animateMapView<span class="token punctuation">,</span>
      zoomIn<span class="token punctuation">,</span>
      zoomOut<span class="token punctuation">,</span>
      getMapViewCoord<span class="token punctuation">,</span>
      fitInView<span class="token punctuation">,</span>
      getCoordinatesExtent<span class="token punctuation">,</span>
      addIconMarkers<span class="token punctuation">,</span>
      removeLayer<span class="token punctuation">,</span>
      addDrawLayer<span class="token punctuation">,</span>
      addWKTGeoOnSource<span class="token punctuation">,</span>
      fitInFeaturesOrGeometries<span class="token punctuation">,</span>
      getDistance<span class="token punctuation">,</span>
      getGeoCenterFromLngLats<span class="token punctuation">,</span>
      getMetersPerUnit<span class="token punctuation">,</span>
    <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../js/TMap.js&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> option <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">targetContainerId</span><span class="token operator">:</span> <span class="token string">&quot;mapContainer1&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">centerLng</span><span class="token operator">:</span> <span class="token number">104.076693</span><span class="token punctuation">,</span>
      <span class="token literal-property property">centerLat</span><span class="token operator">:</span> <span class="token number">30.513315</span><span class="token punctuation">,</span>
      <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
      <span class="token literal-property property">baseMap</span><span class="token operator">:</span> <span class="token string">&quot;vector&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> TMap<span class="token punctuation">,</span> baseLayer <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">initMap</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//#endregion init</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;当前视图对象：&quot;</span><span class="token punctuation">,</span> <span class="token function">getMapView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//改变中心点与缩放</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;setMapView&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setMapVIew</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">103.043</span><span class="token punctuation">,</span> <span class="token number">31.012312</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;animateMapView&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">animateMapView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>
        <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">103.043</span><span class="token punctuation">,</span> <span class="token number">31.012312</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        <span class="token literal-property property">durationTime</span><span class="token operator">:</span> <span class="token number">3000</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 放大</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;zoomIn&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">zoomIn</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// 缩小</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;zoomOut&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">zoomOut</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;当前地图视口：&quot;</span><span class="token punctuation">,</span> <span class="token function">getMapViewCoord</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token punctuation">{</span> extent <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getMapViewCoord</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//复原</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;reset&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">fitInView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> extent<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">padding</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> points <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">103.02</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">31.11</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">103.54</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">31.01</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;点位extent:&quot;</span><span class="token punctuation">,</span> <span class="token function">getCoordinatesExtent</span><span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//撒点</span>
    <span class="token keyword">let</span> layer<span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;fitPoints&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      layer <span class="token operator">&amp;&amp;</span> <span class="token function">removeLayer</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> layer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      layer <span class="token operator">=</span> <span class="token function">addIconMarkers</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> points<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> coordsObj <span class="token operator">=</span> <span class="token function">getCoordinatesExtent</span><span class="token punctuation">(</span>points<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">fitInView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> coordsObj<span class="token punctuation">.</span>extent<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// fitInView(TMap, coordsObj.geom);</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">//区域上图适应显示</span>
    <span class="token keyword">let</span> areaLayer<span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;fitGeos&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      areaLayer <span class="token operator">&amp;&amp;</span> <span class="token function">removeLayer</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> areaLayer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> drawSource<span class="token punctuation">,</span> drawLayer <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">addDrawLayer</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
      areaLayer <span class="token operator">=</span> drawLayer<span class="token punctuation">;</span>
      <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          <span class="token constant">WKT</span><span class="token operator">:</span> <span class="token string">&quot;POLYGON((104.054595 30.544729,104.042064 30.514688,104.090301 30.489626,104.128066 30.533743,104.100257 30.543356,104.054595 30.544729))&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">radius</span><span class="token operator">:</span> <span class="token number">0.04223358312131609</span><span class="token punctuation">,</span>
          <span class="token constant">WKT</span><span class="token operator">:</span> <span class="token string">&quot;POINT(104.1061769104004 30.723644180297853)&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> features <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      arr<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> feature <span class="token operator">=</span> <span class="token function">addWKTGeoOnSource</span><span class="token punctuation">(</span>drawSource<span class="token punctuation">,</span> item<span class="token punctuation">.</span><span class="token constant">WKT</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span>radius<span class="token punctuation">)</span><span class="token punctuation">;</span>
        features<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>feature<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token function">fitInFeaturesOrGeometries</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> features<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
      <span class="token string">&quot;两点距离为：&quot;</span><span class="token punctuation">,</span>
      <span class="token function">getDistance</span><span class="token punctuation">(</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.06</span><span class="token punctuation">,</span>
          <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.67</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.063</span><span class="token punctuation">,</span>
          <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.672</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
      <span class="token string">&quot;坐标中心点为&quot;</span><span class="token punctuation">,</span>
      <span class="token function">getGeoCenterFromLngLats</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.054595</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.544729</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.042064</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.514688</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.090301</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.489626</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.100257</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.543356</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.054595</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.544729</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;1投影单位的米长&quot;</span><span class="token punctuation">,</span> <span class="token function">getMetersPerUnit</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br></div></div></details> <iframe id="iframe" height="500" width="100%" frameborder="0" src="/tmap-ol-doc/demo/view.html"></iframe></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/tmap-ol-doc/pages/TMap/fun/init.html" class="prev">
        地图初始化
      </a></span> <span class="next"><a href="/tmap-ol-doc/pages/TMap/fun/marker.html">
        地图撒点
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/tmap-ol-doc/assets/js/app.9340124c.js" defer></script><script src="/tmap-ol-doc/assets/js/2.e44ad201.js" defer></script><script src="/tmap-ol-doc/assets/js/52.d54d0ee0.js" defer></script>
  </body>
</html>
