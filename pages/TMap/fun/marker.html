<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>地图撒点 | TMap-OL-Doc</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="icon" href="/tmap-ol-doc/img/logo.png">
    <meta name="description" content="">
    
    <link rel="preload" href="/tmap-ol-doc/assets/css/0.styles.067b666c.css" as="style"><link rel="preload" href="/tmap-ol-doc/assets/js/app.9340124c.js" as="script"><link rel="preload" href="/tmap-ol-doc/assets/js/2.e44ad201.js" as="script"><link rel="preload" href="/tmap-ol-doc/assets/js/51.4fbf4a32.js" as="script"><link rel="prefetch" href="/tmap-ol-doc/assets/js/10.4ac103c5.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/11.38f8f5cc.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/12.dd3edee4.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/13.384d9df2.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/14.43c3abe2.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/15.637aa66e.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/16.2deaaec8.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/17.16c0fa05.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/18.16c1ea9d.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/19.4634a2f9.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/20.9c84fccc.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/21.a88c6bd4.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/22.722b8b53.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/23.38a7c543.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/24.6588a75b.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/25.3d0e1a00.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/26.fa2080c4.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/27.7ea2beb1.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/28.823f2305.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/29.fd7002ce.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/3.18b6b865.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/30.92b1e290.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/31.27434288.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/32.978f13cc.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/33.82ef90e5.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/34.cbbb686c.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/35.1b806614.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/36.c836c359.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/37.5c3e3c9f.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/38.adb52c69.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/39.46cbe929.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/4.ee8b6a20.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/40.0184d80c.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/41.b6a445da.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/42.006dcd91.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/43.ccd14454.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/44.9af99c84.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/45.7beb68d7.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/46.25ed8e4d.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/47.e1fe9df7.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/48.3ec88b93.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/49.83fad0e6.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/5.2e78bccb.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/50.1c326822.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/52.d54d0ee0.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/53.b1c4bcd2.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/54.eea6e6e6.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/6.bacd6f42.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/7.59a949d7.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/8.0b3163c3.js"><link rel="prefetch" href="/tmap-ol-doc/assets/js/9.a786f87a.js">
    <link rel="stylesheet" href="/tmap-ol-doc/assets/css/0.styles.067b666c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/tmap-ol-doc/" class="home-link router-link-active"><img src="/tmap-ol-doc/img/logo.png" alt="TMap-OL-Doc" class="logo"> <span class="site-name can-hide">TMap-OL-Doc</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/tmap-ol-doc/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/tmap-ol-doc/pages/TMap/" class="nav-link router-link-active">
  TMap开发文档
</a></div><div class="nav-item"><a href="/tmap-ol-doc/pages/OL/" class="nav-link">
  OL简明教程
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/tmap-ol-doc/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/tmap-ol-doc/pages/TMap/" class="nav-link router-link-active">
  TMap开发文档
</a></div><div class="nav-item"><a href="/tmap-ol-doc/pages/OL/" class="nav-link">
  OL简明教程
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/tmap-ol-doc/pages/TMap/" aria-current="page" class="sidebar-link">简介</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>开始</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tmap-ol-doc/pages/TMap/start/use.html" class="sidebar-link">使用</a></li><li><a href="/tmap-ol-doc/pages/TMap/start/start.html" class="sidebar-link">开始创建第一个地图</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>功能及示例</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tmap-ol-doc/pages/TMap/fun/init.html" class="sidebar-link">地图初始化</a></li><li><a href="/tmap-ol-doc/pages/TMap/fun/view.html" class="sidebar-link">地图视图</a></li><li><a href="/tmap-ol-doc/pages/TMap/fun/marker.html" aria-current="page" class="active sidebar-link">地图撒点</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/marker.html#在地图添加普通标记点-canvas" class="sidebar-link">在地图添加普通标记点（Canvas）</a></li><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/marker.html#在地图添加覆盖物标记点-element" class="sidebar-link">在地图添加覆盖物标记点（Element）</a></li><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/marker.html#在地图添加标注文字-canvas" class="sidebar-link">在地图添加标注文字（Canvas）</a></li><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/marker.html#在地图添加内部带有文字的标记点-canvas" class="sidebar-link">在地图添加内部带有文字的标记点（Canvas）</a></li><li class="sidebar-sub-header"><a href="/tmap-ol-doc/pages/TMap/fun/marker.html#效果展示" class="sidebar-link">效果展示</a></li></ul></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>API</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tmap-ol-doc/pages/TMap/API/initMap.html" class="sidebar-link">initMap</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/resizeMap.html" class="sidebar-link">resizeMap</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/setMapContainer.html" class="sidebar-link">setMapContainer</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/setBaseMap.html" class="sidebar-link">setBaseMap</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getMapControls.html" class="sidebar-link">getMapControls</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/addMapControl.html" class="sidebar-link">addMapControl</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/removeMapControl.html" class="sidebar-link">removeMapControl</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getMapView.html" class="sidebar-link">getMapView</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/setMapView.html" class="sidebar-link">setMapView</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/animateMapView.html" class="sidebar-link">animateMapView</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/zoomIn.html" class="sidebar-link">zoomIn</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/zoomOut.html" class="sidebar-link">zoomOut</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getMapViewCoord.html" class="sidebar-link">getMapViewCoord</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/fitInView.html" class="sidebar-link">fitInView</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getCoordinatesExtent.html" class="sidebar-link">getCoordinatesExtent</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/fitInFeaturesOrGeometries.html" class="sidebar-link">fitInFeaturesOrGeometries</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getDistance.html" class="sidebar-link">getDistance</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getGeoCenterFromLngLats.html" class="sidebar-link">getGeoCenterFromLngLats</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getMetersPerUnit.html" class="sidebar-link">getMetersPerUnit</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/addIconMarkers.html" class="sidebar-link">addIconMarkers</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/removeLayer.html" class="sidebar-link">removeLayer</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getAllLayers.html" class="sidebar-link">getAllLayers</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/addOverLayMarkers.html" class="sidebar-link">addOverLayMarkers</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/removeOverlay.html" class="sidebar-link">removeOverlay</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getAllOverlays.html" class="sidebar-link">getAllOverlays</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/addVectorLayer.html" class="sidebar-link">addVectorLayer</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/addTextOnSource.html" class="sidebar-link">addTextOnSource</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/removeFeaturesOnSource.html" class="sidebar-link">removeFeaturesOnSource</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/removeFeaturesOnLayer.html" class="sidebar-link">removeFeaturesOnLayer</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getFeaturesFromLayer.html" class="sidebar-link">getFeaturesFromLayer</a></li><li><a href="/tmap-ol-doc/pages/TMap/API/getFeaturesFromSource.html" class="sidebar-link">getFeaturesFromSource</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="地图撒点"><a href="#地图撒点" class="header-anchor">#</a> 地图撒点</h1> <h2 id="在地图添加普通标记点-canvas"><a href="#在地图添加普通标记点-canvas" class="header-anchor">#</a> 在地图添加普通标记点（Canvas）</h2> <p>学完了视图相关方法，接下来，我们将进入到gis系统中一个不可或缺的功能，在地图上撒点，撒点即把一系列带有地理信息的标记点反映在地图上，撒点有很多种,我们在这一章会一一学到</p> <p>首先，我们先来看一下在地图添加普通标记点，可能看到这里会比较疑惑为什么这里是普通标记点，难道还有不普通的？是的，这里对于普通这里不作过多解释，学完整个地图撒点章节你自然就会明白为什么这里是普通了，但是你需要知道的是，一般业务场景中大部分情况都使用普通标记点（渲染速度快，节约性能，使用简单），我们一起来看一下用<code>addIconMarkers</code>这个<code>api</code>是怎么把普通标记点撒在地图上的吧</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token comment">// 普通标记点 撒点及清除</span>
    <span class="token keyword">const</span> icon <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> svg <span class="token operator">=</span>
      <span class="token string">'&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;24&quot; height=&quot;24&quot;&gt;&lt;path fill=&quot;none&quot; d=&quot;M0 0h24v24H0z&quot;/&gt;&lt;path d=&quot;M18.364 17.364L12 23.728l-6.364-6.364a9 9 0 1 1 12.728 0zM12 15a4 4 0 1 0 0-8 4 4 0 0 0 0 8zm0-2a2 2 0 1 1 0-4 2 2 0 0 1 0 4z&quot; fill=&quot;rgba(47,204,113,1)&quot;/&gt;&lt;/svg&gt;'</span><span class="token punctuation">;</span>
    icon<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;data:image/svg+xml,&quot;</span> <span class="token operator">+</span> <span class="token function">encodeURI</span><span class="token punctuation">(</span>svg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> normalMarkerList <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.076693</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.513315</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.076693</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.523315</span><span class="token punctuation">,</span>
        <span class="token literal-property property">src</span><span class="token operator">:</span> <span class="token string">&quot;../img/logo.png&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">showWidth</span><span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.086693</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.503315</span><span class="token punctuation">,</span>
        <span class="token literal-property property">img</span><span class="token operator">:</span> icon<span class="token punctuation">,</span>
        <span class="token literal-property property">imgSize</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> add <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> markerLayer<span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;iconMarkers&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>add<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        markerLayer <span class="token operator">=</span> <span class="token function">addIconMarkers</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> normalMarkerList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> coordsObj <span class="token operator">=</span> <span class="token function">getCoordinatesExtent</span><span class="token punctuation">(</span>normalMarkerList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fitInView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> coordsObj<span class="token punctuation">.</span>extent<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;清除前地图所有层&quot;</span><span class="token punctuation">,</span> <span class="token function">getAllLayers</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">removeLayer</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> markerLayer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">animateMapView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.076693</span><span class="token punctuation">,</span> <span class="token number">30.513315</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      add <span class="token operator">=</span> <span class="token operator">!</span>add<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>点击<a href="/tmap-ol-doc/pages/TMap/fun/marker.html#效果展示">效果展示</a>点击普通标记点按钮看看效果</p> <p>可以看到，点击按钮会在地图上撒了三个不同的点，并且自适应缩放了，缩放不用多说了吧，上一章已经讲的很清楚了，配合使用就可以了，我们主要看一下撒点功能</p> <p>回到代码，<code>addIconMarkers</code>这个方法就是撒点功能，第一个参数还是和其他方法一样，把地图实例传进去，第二个参数接收一个数组，这个数组就是你要在地图上撒的点，我们来看下这个数组里的具体内容，数组有三项，但是每一项都不相同，第一项我们只传了经纬度进去，虽然撒出了点，但显示图标为红色的默认图标，第二项我们多传了<code>src</code>作为图标路径，并且搭配<code>showWidth</code>作为图片宽度（图片会按照传入宽度保持原有比例缩放），所以出现了图片图标，第三项我们在第一项的基础上多传入了<code>img</code>和<code>imgSize</code>（<code>img</code>接收一个<code>image</code>元素，可以通过<code>new Image</code>实例化，也可以获取现有<code>dom</code>的方法，搭配<code>imgSize</code>数组作为图片宽高.我们的例子里是通过实例化一个<code>dom</code>和<code>src</code>拼接<code>svg</code>实现)，可以在地图上看见一个黄色的标记点，注意：<code>img</code>和<code>src</code>不能同时存在，两种只能选其一来实现</p> <p>这里还涉及到了一个撒点清除，撒点返回值为这些标记点所在的layer，要清除撒点只需要通过<code>removeLayer</code>把这个<code>layer</code>清除即可，你也可以通过<code>getLayers</code>获取这些层，点击清除后打开控制台看看结果吧（注意，<code>layers</code>中包含底图图层，所以一般情况下不会出现清除所有图层的需要，只用清除某一层你想清除的图层）</p> <p>相关方法请点击下方链接查看更多：</p> <p><a href="/tmap-ol-doc/pages/TMap/API/addIconMarkers.html">API/addIconMarkers</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/removeLayer.html">API/removeLayer</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/getAllLayers.html">API/getAllLayers</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/fitInView.html">API/fitInView</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/animateMapView.html">API/animateMapView</a></p> <h2 id="在地图添加覆盖物标记点-element"><a href="#在地图添加覆盖物标记点-element" class="header-anchor">#</a> 在地图添加覆盖物标记点（Element）</h2> <p>上一节，我们学习了普通的标记点撒点，从这一节开始，我们将进入“不普通”的标记点撒点的学习，我们一起来看一下这个不普通究竟不普通在哪里</p> <p>这一节标题叫做覆盖物标记点，何为覆盖物？</p> <p>覆盖物实际为OL中的一个概念，通俗理解为，脱离地图<code>Canvas</code>的<code>dom</code>类型地图要素，它虽然脱离了地图的<code>Canvas</code>，但实际还是受地图控制，并反映相关地理信息，你可以在文档流中定位到这些覆盖物，也可以通过<code>css</code>改变样式，他可以是一系列<code>dom</code>的集合，也可以是一个<code>img</code>元素，比起普通的标记点它更加的灵活，支持一些更为复杂的标记点显示</p> <p>我们一起来看下这个标记点的具体实现</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token comment">// 覆盖物标记点 撒点及清除</span>
    <span class="token keyword">const</span> overlayMarkerList <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.076693</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.513315</span><span class="token punctuation">,</span>
        <span class="token literal-property property">elementHtml</span><span class="token operator">:</span> <span class="token string">'&lt;div style=&quot;color:red;&quot;&gt;123456&lt;div&gt;'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.076693</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.523315</span><span class="token punctuation">,</span>
        <span class="token literal-property property">elementHtml</span><span class="token operator">:</span>
          <span class="token string">'&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;24&quot; height=&quot;24&quot;&gt;&lt;path fill=&quot;none&quot; d=&quot;M0 0h24v24H0z&quot;/&gt;&lt;path d=&quot;M18.364 17.364L12 23.728l-6.364-6.364a9 9 0 1 1 12.728 0zM12 15a4 4 0 1 0 0-8 4 4 0 0 0 0 8zm0-2a2 2 0 1 1 0-4 2 2 0 0 1 0 4z&quot; fill=&quot;rgba(47,204,113,1)&quot;/&gt;&lt;/svg&gt;'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.086693</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.503315</span><span class="token punctuation">,</span>
        <span class="token literal-property property">elementHtml</span><span class="token operator">:</span>
          <span class="token string">'&lt;div style=&quot;width:60px;height:60px;background:yellow;display:flex;justify-content: center;align-items: center;&quot;&gt;&lt;img src=&quot;../img/logo.png&quot;/&gt;&lt;/div&gt;'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> addOverlay <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> overlays <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;overlayerMarkers&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>addOverlay<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        overlays <span class="token operator">=</span> <span class="token function">addOverLayMarkers</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> overlayMarkerList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> coordsObj <span class="token operator">=</span> <span class="token function">getCoordinatesExtent</span><span class="token punctuation">(</span>overlayMarkerList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fitInView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> coordsObj<span class="token punctuation">.</span>extent<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;清除前地图所有覆盖物&quot;</span><span class="token punctuation">,</span> <span class="token function">getAllOverlays</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        overlays<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">overlay</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">removeOverlay</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> overlay<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">animateMapView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.076693</span><span class="token punctuation">,</span> <span class="token number">30.513315</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      addOverlay <span class="token operator">=</span> <span class="token operator">!</span>addOverlay<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>点击<a href="/tmap-ol-doc/pages/TMap/fun/marker.html#效果展示">效果展示</a>点击覆盖物标记点按钮看看效果</p> <p>可以看到这次地图上显示了三个要素，一个svg图标，一段文字，一个外层包裹div的图片，这些都可以用覆盖物类型的标记点实现，对比一下普通标记点，是不是要灵活很多，涉及到一些嵌套结构，自定义图形，带有文字的图形，组合结构等都可以用覆盖物类型的标记点来实现。</p> <p>我们看看代码，用法也和普通标记点十分类似，都是传入地图实例和数组形式的标记点，只是方法名与数组内的结构以及返回值有所差别，我们一个个来看，数组内一共有三项，三项结构都是一样的，<code>lng</code>，<code>lat</code>这两项不用多说了吧，<code>elementHtml</code>是我们比较陌生的一个字段，这个字段接收一个<code>html</code>字符串结构，只要是<code>html</code>字符串就能够解析出来并反映在地图上，我们也看到了，这三个字符串分别实现了<code>svg</code>，文字和嵌套结构的标注上图，不同于普通标记点，覆盖物标记点的方法返回值为一个数组，这个数组包含了所有创建覆盖物的实例对象，通过<code>removeOverlay</code>作为第二个参数遍历清除，当然你如果能保证你的地图上不存在其他覆盖物，你可以不传第二个参数清除所有覆盖物,你也可以通过<code>getAllOverlays</code>获取查看地图上的所有覆盖物,点击清除打开控制台看看所获取的清除前的所有覆盖物</p> <p>这样看来，似乎覆盖物类型的标记点功能更强大更好用一些，那为什么在章节开头说了，一般都使用普通的标记点来满足基本业务需要呢？的确，覆盖物类型确实更加灵活方便，但是我们作为前端工程师，需要考虑的问题可不只有功能层面的实现，覆盖物类型的标记点实际上是在文档流内进行元素的创建与位置的改变，是对<code>dom</code>的操作，如果标记点的数据量比较大的情况，会在文档流内创建数量十分庞大的<code>dom</code>节点，无疑会影响到整个页面的性能，所以一般情况都下推荐不使用这种形式的标记点，除非标记点样式无法用普通形式实现或者能够确定数据量比较小的情况</p> <p>相关方法请点击下方链接查看更多：</p> <p><a href="/tmap-ol-doc/pages/TMap/API/addOverLayMarkers.html">API/addOverLayMarkers</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/removeOverlay.html">API/removeOverlay</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/getAllOverlays.html">API/getAllOverlays</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/fitInView.html">API/fitInView</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/animateMapView.html">API/animateMapView</a></p> <h2 id="在地图添加标注文字-canvas"><a href="#在地图添加标注文字-canvas" class="header-anchor">#</a> 在地图添加标注文字（Canvas）</h2> <p>刚刚已经学习了基本的图标类型标注上图，这一节我们来看下标注文字如何展示在地图上，实际上，上一节我们在覆盖物标记点中提到了一种文字上图的方法，确实，<code>html</code>实现一个文字上图是最简单不过了，但是，还是那个问题，毕竟是创建<code>dom</code>，大数据量的情况下难免出现卡顿，况且，为了一个简单的文字上图就操作<code>dom</code>似乎有点成本过高，那我们实际业务需求中遇到需要地图文字上图的情况该怎么解决呢？</p> <p>我们知道文字也是可以通过<code>canvas</code>显示出来的，那地图就必然提供了<code>canvas</code>的实现方案，和普通标注点的底层原理类似，通过<code>addVectorLayer</code>和<code>addTextOnSource</code>可以实现文字的标注上图，我们来看一下如何实现吧</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token comment">//文字标注上图及清除</span>
    <span class="token keyword">const</span> textObj <span class="token operator">=</span> <span class="token function">addVectorLayer</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> textLayer <span class="token operator">=</span> textObj<span class="token punctuation">.</span>vectorLayer<span class="token punctuation">;</span>
    <span class="token keyword">const</span> textSource <span class="token operator">=</span> textObj<span class="token punctuation">.</span>vectorSource<span class="token punctuation">;</span>
    <span class="token keyword">const</span> textList <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.076693</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.513315</span><span class="token punctuation">,</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&quot;文字1&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">textColor</span><span class="token operator">:</span> <span class="token string">&quot;red&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.076693</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.523315</span><span class="token punctuation">,</span>
        <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&quot;文字2&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">textColor</span><span class="token operator">:</span> <span class="token string">&quot;#57e6e6&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">font</span><span class="token operator">:</span> <span class="token string">&quot;bold 30px '华文彩云','serif'&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.086693</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.503315</span><span class="token punctuation">,</span>
        <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&quot;文字3&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">textBackground</span><span class="token operator">:</span> <span class="token string">&quot;#fff&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">borderColor</span><span class="token operator">:</span> <span class="token string">&quot;#000&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">borderWidth</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> addText <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> textFeatures <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;textMarkers&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>addText<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        textFeatures <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        textList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> textFeature <span class="token operator">=</span> <span class="token function">addTextOnSource</span><span class="token punctuation">(</span>textSource<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
          textFeatures<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>textFeature<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> coordsObj <span class="token operator">=</span> <span class="token function">getCoordinatesExtent</span><span class="token punctuation">(</span>textList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fitInView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> coordsObj<span class="token punctuation">.</span>extent<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">removeFeaturesOnSource</span><span class="token punctuation">(</span>textSource<span class="token punctuation">,</span> textFeatures<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// removeFeaturesOnLayer(textLayer, textFeatures);</span>
        <span class="token function">animateMapView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.076693</span><span class="token punctuation">,</span> <span class="token number">30.513315</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      addText <span class="token operator">=</span> <span class="token operator">!</span>addText<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// removeLayer(TMap, textLayer);</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>点击<a href="/tmap-ol-doc/pages/TMap/fun/marker.html#效果展示">效果展示</a>点击文字标记按钮看看效果</p> <p>可以看到，我们在地图上一共实现了三处文字标记，可以看到这个方法不但可以实现文字颜色及字体大小的自定义，还可以实现背景和边框等，基本能够满足文字上图的需求了</p> <p>再看下具体实现代码，创建不同于之前的两个标记点方法，文字标注点方法需要两个<code>api</code>配合使用，第一个方法<code>addVectorLayer</code>为在地图上创建一个矢量图层，这是<code>OL</code>中一个很重要的概念，这里就不展开讲了，感兴趣可以去<a href="/tmap-ol-doc/pages/OL/base/Layer">ol/Layer</a>深入了解一下，基本上大多数地图要素需要创建在矢量图层上，文字要素也不例外，这个方法返回了创建的图层<code>vectorLayer</code>与数据源<code>vectorSource</code>，而数据源<code>source</code>也是<code>OL</code>中的概念，<a href="/tmap-ol-doc/pages/OL/base/Source">ol/Source</a>，我们把要素添加到数据源上就可以实现要素在地图的显示，所以第二个方法<code>addTextOnSource</code>就是要把这些文字要素添加在数据源上，是不是很好理解了，传入参数不再是地图实例而是数据源，因为这个数据源所属的层已经添加在地图上了，所以我们的参数只要数据源实例对象和文字相关配置就够了，看下这个配置，配置里有我们很熟悉的<code>lng</code>，<code>lat</code>代表文字所在的经纬度，还有一些其他参数，这些参数基本上就是用来控制文字的样式了，注意这里的<code>font</code>属性，是一个字符串，里面包含了字体，字号及字体是否加粗，如果你用过<code>canvas</code>的<code>text</code>渲染的话你对这个属性值的标准格式会十分熟悉，因为这就是<a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/font" target="_blank" rel="noopener noreferrer">CanvasRenderingContext2D.font<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>的标准数据格式，用法也十分简单，了解就可以了，这里添加文字的方法不同于上面两个方法，它所接受的是一个文字配置对象而不是数组，所以如果你想展示多个的话，就需要遍历渲染，它的返回值就是文字要素，要素也是<code>OL</code>中一个十分重要的概念，详情请了解<a href="/tmap-ol-doc/pages/OL/base/Feature">ol/Feature</a>，我们清除的时候需要调用<code>removeFeaturesOnSource</code>方法把这些要素从数据源里清除，当然也可以使用<code>removeFeaturesOnLayer</code>方法清除这个层上的某些要素，这两个方法都是接收一个要素数组，其原理是一样的，唯一区别就是第一个参数，这个就要看具体使用时你能拿到这个层，还是数据源，当然两者你都能拿到的话，两个方法就凭个人喜好选用了，可以看到这里还注释了一个方法<code>removeLayer</code>，当然，这是创建要素在层上，你大可移除这个层来移除要素，但是这个使用的前提是你确定你不需要再往该层继续添加要素，如果需要频繁改变文字要素，还是保留这个层，不然就需要一直去创建矢量图层来达到目的，具体还是要理解后结合业务场景选用合适的方法，当然，这里既然提到了要素，那来顺便说一下获取要素的方法吧，很简单，通过传入<code>Layer</code>对象调用<code>getFeaturesFromLayer</code>获取当前层上的要素,当然你也可以通过传入<code>Source</code>对象调用<code>getFeaturesFromSource</code>来获取当前数据源的要素</p> <p>相关方法请点击下方链接查看更多：</p> <p><a href="/tmap-ol-doc/pages/TMap/API/addVectorLayer.html">API/addVectorLayer</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/addTextOnSource.html">API/addTextOnSource</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/removeFeaturesOnSource.html">API/removeFeaturesOnSource</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/removeFeaturesOnLayer.html">API/removeFeaturesOnLayer</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/removeLayer.html">API/removeLayer</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/getFeaturesFromLayer.html">API/getFeaturesFromLayer</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/getFeaturesFromSource.html">API/getFeaturesFromSource</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/fitInView.html">API/fitInView</a></p> <p><a href="/tmap-ol-doc/pages/TMap/API/animateMapView.html">API/animateMapView</a></p> <h2 id="在地图添加内部带有文字的标记点-canvas"><a href="#在地图添加内部带有文字的标记点-canvas" class="header-anchor">#</a> 在地图添加内部带有文字的标记点（Canvas）</h2> <p>刚刚我们学习了一种文字上图的方式，实际场景中单纯文字上图的使用情况并不多，文字一般都是结合图片背景或者容器作为一个嵌套结构标记在点地图上，容器嵌套文字若是简单的矩形可以用<code>addTextOnSource</code>添加带有背景色的文字实现，若是复杂的结构或样式我们只能用<code>addOverLayMarkers</code>来实现了，那图片中内嵌文字的情况呢？当然，我们还是可以用<code>addOverLayMarkers</code>去实现，但我们有更好的实现方案，我们一起来试试<code>addTextMarkers</code>方法吧</p> <h2 id="效果展示"><a href="#效果展示" class="header-anchor">#</a> 效果展示</h2> <details class="custom-block details"><summary>点击查看完整实现代码</summary> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>en<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>UTF-8<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>X-UA-Compatible<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>IE=edge<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>width=device-width, initial-scale=1.0<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>stylesheet<span class="token punctuation">&quot;</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../css/ol.css<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../js/ol.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>../js/mapConfig.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Document<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">body</span> <span class="token punctuation">{</span>
      <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
      <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">#mapContainer</span> <span class="token punctuation">{</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 100vw<span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>
      <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token selector">.buttons</span> <span class="token punctuation">{</span>
      <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
      <span class="token property">right</span><span class="token punctuation">:</span> 50%<span class="token punctuation">;</span>
      <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
      <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translateX</span><span class="token punctuation">(</span>50%<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.buttons button</span> <span class="token punctuation">{</span>
      <span class="token property">background</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
      <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
      <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #666666<span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> #333333<span class="token punctuation">;</span>
      <span class="token property">border-radius</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>
      <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>mapContainer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>buttons<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>iconMarkers<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>普通标记点/清除<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>overlayerMarkers<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>覆盖物标记点/清除<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>textMarks<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>文字标记/清除<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token comment">&lt;!-- &lt;button id=&quot;darkBtn&quot;&gt;图标嵌套文字标记点/清除&lt;/button&gt;
      &lt;button id=&quot;addControlBtn&quot;&gt;添加/删除一个全屏组件&lt;/button&gt; --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>module<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
    <span class="token keyword">import</span> <span class="token punctuation">{</span>
      initMap<span class="token punctuation">,</span>
      addIconMarkers<span class="token punctuation">,</span>
      removeLayer<span class="token punctuation">,</span>
      getCoordinatesExtent<span class="token punctuation">,</span>
      fitInView<span class="token punctuation">,</span>
      animateMapView<span class="token punctuation">,</span>
      addOverLayMarkers<span class="token punctuation">,</span>
      removeOverlay<span class="token punctuation">,</span>
      getAllLayers<span class="token punctuation">,</span>
      getAllOverlays<span class="token punctuation">,</span>
      removeFeaturesOnSource<span class="token punctuation">,</span>
      addTextOnSource<span class="token punctuation">,</span>
      addVectorLayer<span class="token punctuation">,</span>
      removeFeaturesOnLayer<span class="token punctuation">,</span>
    <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../js/TMap.js&quot;</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> option <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">targetContainerId</span><span class="token operator">:</span> <span class="token string">&quot;mapContainer&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">centerLng</span><span class="token operator">:</span> <span class="token number">104.076693</span><span class="token punctuation">,</span>
      <span class="token literal-property property">centerLat</span><span class="token operator">:</span> <span class="token number">30.513315</span><span class="token punctuation">,</span>
      <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
      <span class="token literal-property property">baseMap</span><span class="token operator">:</span> <span class="token string">&quot;vector&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> TMap<span class="token punctuation">,</span> baseLayer <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">initMap</span><span class="token punctuation">(</span>option<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 普通标记点 撒点及清除</span>
    <span class="token keyword">const</span> icon <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Image</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> svg <span class="token operator">=</span>
      <span class="token string">'&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;24&quot; height=&quot;24&quot;&gt;&lt;path fill=&quot;none&quot; d=&quot;M0 0h24v24H0z&quot;/&gt;&lt;path d=&quot;M18.364 17.364L12 23.728l-6.364-6.364a9 9 0 1 1 12.728 0zM12 15a4 4 0 1 0 0-8 4 4 0 0 0 0 8zm0-2a2 2 0 1 1 0-4 2 2 0 0 1 0 4z&quot; fill=&quot;rgba(47,204,113,1)&quot;/&gt;&lt;/svg&gt;'</span><span class="token punctuation">;</span>
    icon<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token string">&quot;data:image/svg+xml,&quot;</span> <span class="token operator">+</span> <span class="token function">encodeURI</span><span class="token punctuation">(</span>svg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> normalMarkerList <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.076693</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.513315</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.076693</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.523315</span><span class="token punctuation">,</span>
        <span class="token literal-property property">src</span><span class="token operator">:</span> <span class="token string">&quot;../img/logo.png&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">showWidth</span><span class="token operator">:</span> <span class="token number">24</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.086693</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.503315</span><span class="token punctuation">,</span>
        <span class="token literal-property property">img</span><span class="token operator">:</span> icon<span class="token punctuation">,</span>
        <span class="token literal-property property">imgSize</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> add <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> markerLayer<span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;iconMarkers&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>add<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        markerLayer <span class="token operator">=</span> <span class="token function">addIconMarkers</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> normalMarkerList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> coordsObj <span class="token operator">=</span> <span class="token function">getCoordinatesExtent</span><span class="token punctuation">(</span>normalMarkerList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fitInView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> coordsObj<span class="token punctuation">.</span>extent<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;清除前地图所有层&quot;</span><span class="token punctuation">,</span> <span class="token function">getAllLayers</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">removeLayer</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> markerLayer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">animateMapView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.076693</span><span class="token punctuation">,</span> <span class="token number">30.513315</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      add <span class="token operator">=</span> <span class="token operator">!</span>add<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// 覆盖物标记点 撒点及清除</span>
    <span class="token keyword">const</span> overlayMarkerList <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.076693</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.513315</span><span class="token punctuation">,</span>
        <span class="token literal-property property">elementHtml</span><span class="token operator">:</span> <span class="token string">'&lt;div style=&quot;color:red;&quot;&gt;123456&lt;div&gt;'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.076693</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.523315</span><span class="token punctuation">,</span>
        <span class="token literal-property property">elementHtml</span><span class="token operator">:</span>
          <span class="token string">'&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 24 24&quot; width=&quot;24&quot; height=&quot;24&quot;&gt;&lt;path fill=&quot;none&quot; d=&quot;M0 0h24v24H0z&quot;/&gt;&lt;path d=&quot;M18.364 17.364L12 23.728l-6.364-6.364a9 9 0 1 1 12.728 0zM12 15a4 4 0 1 0 0-8 4 4 0 0 0 0 8zm0-2a2 2 0 1 1 0-4 2 2 0 0 1 0 4z&quot; fill=&quot;rgba(47,204,113,1)&quot;/&gt;&lt;/svg&gt;'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.086693</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.503315</span><span class="token punctuation">,</span>
        <span class="token literal-property property">elementHtml</span><span class="token operator">:</span>
          <span class="token string">'&lt;div style=&quot;width:60px;height:60px;background:yellow;display:flex;justify-content: center;align-items: center;&quot;&gt;&lt;img src=&quot;../img/logo.png&quot;/&gt;&lt;/div&gt;'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> addOverlay <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> overlays <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;overlayerMarkers&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>addOverlay<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        overlays <span class="token operator">=</span> <span class="token function">addOverLayMarkers</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> overlayMarkerList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> coordsObj <span class="token operator">=</span> <span class="token function">getCoordinatesExtent</span><span class="token punctuation">(</span>overlayMarkerList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fitInView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> coordsObj<span class="token punctuation">.</span>extent<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;清除前地图所有覆盖物&quot;</span><span class="token punctuation">,</span> <span class="token function">getAllOverlays</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        overlays<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">overlay</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token function">removeOverlay</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> overlay<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">animateMapView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.076693</span><span class="token punctuation">,</span> <span class="token number">30.513315</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      addOverlay <span class="token operator">=</span> <span class="token operator">!</span>addOverlay<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">//文字标注上图及清除</span>
    <span class="token keyword">const</span> textObj <span class="token operator">=</span> <span class="token function">addVectorLayer</span><span class="token punctuation">(</span>TMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> textLayer <span class="token operator">=</span> textObj<span class="token punctuation">.</span>vectorLayer<span class="token punctuation">;</span>
    <span class="token keyword">const</span> textSource <span class="token operator">=</span> textObj<span class="token punctuation">.</span>vectorSource<span class="token punctuation">;</span>
    <span class="token keyword">const</span> textList <span class="token operator">=</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span> <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.076693</span><span class="token punctuation">,</span> <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.513315</span><span class="token punctuation">,</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&quot;文字1&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">textColor</span><span class="token operator">:</span> <span class="token string">&quot;red&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.076693</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.523315</span><span class="token punctuation">,</span>
        <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&quot;文字2&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">textColor</span><span class="token operator">:</span> <span class="token string">&quot;#57e6e6&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">font</span><span class="token operator">:</span> <span class="token string">&quot;bold 30px '华文彩云','serif'&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        <span class="token literal-property property">lng</span><span class="token operator">:</span> <span class="token number">104.086693</span><span class="token punctuation">,</span>
        <span class="token literal-property property">lat</span><span class="token operator">:</span> <span class="token number">30.503315</span><span class="token punctuation">,</span>
        <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&quot;文字3&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">textBackground</span><span class="token operator">:</span> <span class="token string">&quot;#fff&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">borderColor</span><span class="token operator">:</span> <span class="token string">&quot;#000&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">borderWidth</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> addText <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> textFeatures <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&quot;textMarks&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>addText<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        textFeatures <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        textList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">const</span> textFeature <span class="token operator">=</span> <span class="token function">addTextOnSource</span><span class="token punctuation">(</span>textSource<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">;</span>
          textFeatures<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>textFeature<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> coordsObj <span class="token operator">=</span> <span class="token function">getCoordinatesExtent</span><span class="token punctuation">(</span>textList<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">fitInView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> coordsObj<span class="token punctuation">.</span>extent<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">removeFeaturesOnSource</span><span class="token punctuation">(</span>textSource<span class="token punctuation">,</span> textFeatures<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// removeFeaturesOnLayer(textLayer, textFeatures);</span>
        <span class="token function">animateMapView</span><span class="token punctuation">(</span>TMap<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">zoom</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token literal-property property">center</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">104.076693</span><span class="token punctuation">,</span> <span class="token number">30.513315</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      addText <span class="token operator">=</span> <span class="token operator">!</span>addText<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// removeLayer(TMap, textLayer);</span>
  </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br></div></div></details> <iframe id="iframe" height="500" width="100%" frameborder="0" src="/tmap-ol-doc/demo/marker.html"></iframe></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/tmap-ol-doc/pages/TMap/fun/view.html" class="prev">
        地图视图
      </a></span> <span class="next"><a href="/tmap-ol-doc/pages/TMap/API/initMap.html">
        initMap
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/tmap-ol-doc/assets/js/app.9340124c.js" defer></script><script src="/tmap-ol-doc/assets/js/2.e44ad201.js" defer></script><script src="/tmap-ol-doc/assets/js/51.4fbf4a32.js" defer></script>
  </body>
</html>
